# 游戏流程

## 游戏初始化
在 [src/store/combinedGameStore.ts](mdc:src/store/combinedGameStore.ts) 中实现:
- `startNewGame` - 初始化游戏状态，生成棋盘和初始卡牌
- `loadLevel` - 加载特定关卡，设置敌人和地图

## 游戏回合流程
1. **回合开始**
   - 玩家回复全部能量
   - 将上一回合剩余手牌放入弃牌堆
   - 从牌库抽取新手牌

2. **玩家行动阶段**
   - 使用卡牌部署单位或施放法术
   - 触发数独检查，应用加成效果
   - 处理单位交互和战斗

3. **回合结束**
   - 检查胜利或失败条件
   - 更新游戏状态和界面
   - 开始新回合

## 卡牌使用流程
在 `playCard` 函数中:
1. 检查能量是否足够
2. 消耗对应能量
3. 从手牌中移除该卡牌
4. 根据卡牌类型执行不同逻辑:
   - 单位牌: 部署单位，仅将该牌放入弃牌堆
   - 法术牌: 施放法术，所有手牌进入弃牌堆

## 战斗判定
在 `startRegionBattle` 函数和 `executeBattle` 函数中:
1. 计算战斗力
2. 确定胜负
3. 应用战斗后果:
   - 胜利: 移除所有敌人
   - 失败: 我方单位受到伤害

## 胜利与失败条件
- **胜利**: 消灭所有敌人或完成特定关卡目标
- **失败**: 所有玩家单位被消灭或特定游戏条件触发
